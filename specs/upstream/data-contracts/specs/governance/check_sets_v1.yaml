version: 1
profiles:
  critical:
    checks:
      - id: runtime.critical_check_set_manifest_required
        kind: manifest_non_empty
        path: /specs/governance/check_sets_v1.yaml
        profile: critical
        key: checks
      - id: runtime.status_ingest_job_present
        kind: file_tokens
        path: /.github/workflows/ci.yml
        must_contain:
          - runner-status-ingest:
          - ./scripts/runner_status_ingest.sh --max-age-hours 72 --enforce-freshness
      - id: runtime.matrix_artifacts_emitted
        kind: file_tokens
        path: /.github/workflows/ci.yml
        must_contain:
          - .artifacts/runner-status-matrix.json
          - .artifacts/runner-status-matrix.md
          - .artifacts/runner-status-ingest-log.json
      - id: runtime.control_plane_ci_runner_execution_forbidden
        kind: file_tokens
        path: /.github/workflows/ci.yml
        must_not_contain:
          - scripts/runner_bin.sh
      - id: runtime.compatibility_status_freshness_within_slo
        kind: file_tokens
        path: /scripts/runner_status_ingest.sh
        must_contain:
          - --max-age-hours
          - --enforce-freshness
          - compatibility_stale_or_missing_count
          - 72
      - id: runtime.compatibility_missing_status_visibility_required
        kind: file_tokens
        path: /scripts/runner_status_ingest.sh
        must_contain:
          - freshness_state
          - missing
          - policy_effect
      - id: docs.readme_task_usage_paths_present
        kind: file_tokens
        path: /README.md
        must_contain:
          - How Users Use This Repository
          - Author a spec change
          - Validate docs and contract coherence
          - Read compatibility and status telemetry
          - Debug governance or docs drift
      - id: docs.readme_makefile_cookbook_forbidden
        kind: file_tokens
        path: /README.md
        must_not_contain:
          - make setup
          - make prepush
          - hooks-install
  full:
    checks:
      - id: runtime.full_check_set_manifest_required
        kind: manifest_non_empty
        path: /specs/governance/check_sets_v1.yaml
        profile: full
        key: checks
      - id: runtime.runner_status_report_schema_valid
        kind: file_tokens
        path: /specs/schema/runner_status_report_v1.yaml
        must_contain:
          - type: runtime.runner_status_report
          - runner_id
          - implementation_repo
          - generated_at
          - fresh_until
          - command_results
          - artifact_refs
      - id: runtime.runner_status_matrix_schema_valid
        kind: file_tokens
        path: /specs/schema/runner_status_matrix_v1.yaml
        must_contain:
          - type: runtime.runner_status_matrix
          - matrix_rows
          - freshness_state
          - policy_effect
      - id: runtime.compatibility_status_ingestion_configured
        kind: file_tokens
        path: /scripts/runner_status_ingest.sh
        must_contain:
          - release_api_url
          - runner-status-matrix.json
          - runner-status-matrix.md
          - runner-status-ingest-log.json
      - id: runtime.contracts_no_rust_primary_language
        kind: file_tokens
        path: /specs/contract/12_runner_interface.md
        must_contain:
          - implementation-agnostic boundary
          - control plane
      - id: runtime.docs_no_required_lane_language
        kind: file_tokens
        path: /README.md
        must_contain:
          - implementation-agnostic control plane
          - does not execute runtime lanes
      - id: docs.usage_guides_required_set_present
        kind: file_tokens
        path: /docs/book/reference_manifest.yaml
        must_contain:
          - /docs/book/guides/guide_01_onboarding.md
          - /docs/book/guides/guide_10_reference_navigation_patterns.md
      - id: docs.reference_manifest_guide_order_canonical
        kind: file_ordered_tokens
        path: /docs/book/reference_manifest.yaml
        ordered_tokens:
          - /docs/book/guides/index.md
          - /docs/book/guides/guide_01_onboarding.md
          - /docs/book/guides/guide_02_first_spec_authoring.md
          - /docs/book/guides/guide_03_running_checks_and_gates.md
          - /docs/book/guides/guide_04_debugging_failures.md
          - /docs/book/guides/guide_05_release_and_change_control.md
          - /docs/book/guides/guide_06_governance_tuning.md
          - /docs/book/guides/guide_07_schema_extension_workflow.md
          - /docs/book/guides/guide_08_ci_integration.md
          - /docs/book/guides/guide_09_status_exchange_operations.md
          - /docs/book/guides/guide_10_reference_navigation_patterns.md
      - id: docs.guide_contract_links_valid
        kind: file_tokens
        path: /docs/book/90_reference_guide.md
        must_contain:
          - Guide To Contract Map
          - specs/contract/10_docs_quality.md
          - specs/contract/27_runner_status_exchange.md
      - id: docs.visual_aids_core_chapters_present
        kind: file_tokens
        path: /specs/contract/10_docs_quality.md
        must_contain:
          - 05_what_is_data_contracts.md
          - 15_spec_lifecycle.md
          - 25_system_topology.md
          - Mermaid
