type: runtime.runner_build_tool_contract
version: 1
required:
  - version
  - required_tasks
  - optional_tasks
  - task_map
properties:
  version:
    type: integer
    const: 1
  required_tasks:
    type: array
    minItems: 1
    items:
      type: object
      required: [task_id, norm]
      properties:
        task_id:
          type: string
          minLength: 1
          enum:
            - build
            - test
            - verify
            - bundle-sync
            - bundle-sync-check
            - compat-check
            - smoke
            - package-check
            - release-verify
            - docs-check
            - lint
            - typecheck
        norm:
          type: string
          enum: [MUST]
  optional_tasks:
    type: array
    items:
      type: object
      required: [task_id, norm]
      properties:
        task_id:
          type: string
          minLength: 1
          enum:
            - build
            - test
            - verify
            - bundle-sync
            - bundle-sync-check
            - compat-check
            - smoke
            - package-check
            - release-verify
            - docs-check
            - lint
            - typecheck
        norm:
          type: string
          enum: [MAY]
  task_map:
    type: object
    minProperties: 1
    additionalProperties:
      type: object
      required: [supported, invocations, tool_kind]
      properties:
        supported:
          type: boolean
        invocations:
          type: array
          minItems: 1
          items:
            type: string
            minLength: 1
        tool_kind:
          type: string
          enum: [xtask, make, composer, shell, custom]
        notes:
          type: string
