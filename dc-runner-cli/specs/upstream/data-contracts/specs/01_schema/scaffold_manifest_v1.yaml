version: 1
title: scaffold_manifest_v1
type: object
required:
  - version
  - bundle_id
  - bundle_version
  - source_commit
  - payload
  - include
  - exclude
  - materialization
properties:
  version:
    type: integer
    enum:
      - 1
  bundle_id:
    type: string
    minLength: 1
  bundle_version:
    type: string
    minLength: 1
  source_commit:
    type: string
    minLength: 1
  payload:
    type: object
    required:
      - files_root
      - templates_root
    properties:
      files_root:
        type: string
        minLength: 1
      templates_root:
        type: string
        minLength: 1
  include:
    type: object
    required:
      - paths
    properties:
      paths:
        type: array
        minItems: 1
        items:
          type: string
          minLength: 1
  exclude:
    type: object
    required:
      - paths
    properties:
      paths:
        type: array
        items:
          type: string
          minLength: 1
  variables:
    type: array
    items:
      type: object
      required:
        - name
        - type
      properties:
        name:
          type: string
          minLength: 1
        type:
          type: string
          enum:
            - string
            - boolean
            - integer
        default:
          oneOf:
            - type: string
            - type: boolean
            - type: integer
  materialization:
    type: object
    required:
      - entries
    properties:
      entries:
        type: array
        minItems: 1
        items:
          type: object
          required:
            - target_path
            - source
            - mode
            - required
          properties:
            target_path:
              type: string
              minLength: 1
            source:
              type: object
              required:
                - kind
                - path
              properties:
                kind:
                  type: string
                  enum:
                    - file
                    - template
                path:
                  type: string
                  minLength: 1
            mode:
              type: string
              enum:
                - overwrite
                - create_only
            required:
              type: boolean
  post_write_checks:
    type: array
    items:
      type: object
      required:
        - id
        - kind
      properties:
        id:
          type: string
          minLength: 1
        kind:
          type: string
          enum:
            - exists
            - not_exists
            - contains
        path:
          type: string
          minLength: 1
        value:
          type: string
          minLength: 1
